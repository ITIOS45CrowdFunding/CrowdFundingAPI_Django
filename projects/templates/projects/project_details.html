{% extends 'projects/base.html' %}
{% block title%}{{ project.title }} | Crowdfund{% endblock %} {% block content %}
<div class="max-w-6xl mx-auto px-4 py-8">
  <!-- Project Title -->
  <h2 class="text-3xl font-bold text-gray-800 mb-2">{{ project.title }}</h2>

  <!-- Tags -->
  <div class="flex flex-wrap gap-2 mb-4">
    {% for tag in tags %}
    <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full"
      >{{ tag.tag.name }}</span
    >
    {% empty %}
    <span class="text-gray-400">No tags</span>
    {% endfor %}
  </div>

  <!-- Image Gallery -->
  {% comment %}
  <div class="overflow-x-auto whitespace-nowrap space-x-4 mb-6 flex">
    {% for image in images %}
    <img
      src="{{ image.image.url }}"
      alt="Project Image"
      class="h-48 rounded shadow inline-block"
    />
    {% empty %}
    <p class="text-gray-500">No images uploaded.</p>
    {% endfor %}
  </div>
  {% endcomment %}
  <div class="swiper mySwiper w-full max-w-4xl mx-auto rounded shadow">
    <div class="swiper-wrapper">
      {% for image in images %}
      <div class="swiper-slide">
        <img src="{{ image.image.url }}" class="w-full" alt="Project Image" />
      </div>
      {% endfor %}
    </div>

    <!-- Navigation buttons -->
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>

    <!-- Pagination (optional) -->
    <div class="swiper-pagination"></div>
  </div>

  <!-- Project Description -->
  <div class="bg-white shadow p-6 rounded-lg mb-6">
    <h3 class="text-xl font-semibold mb-2">Details</h3>
    <p class="text-gray-700">{{ project.details }}</p>
  </div>

  <!-- Donation Summary -->
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
    <div class="bg-green-50 p-4 rounded border border-green-200">
      <h4 class="font-semibold text-green-700 mb-1">Target</h4>
      <p class="text-green-900">{{ project.target }} EGP</p>
    </div>
    <div class="bg-blue-50 p-4 rounded border border-blue-200">
      <h4 class="font-semibold text-blue-700 mb-1">Total Donations</h4>
      <p class="text-blue-900">{{ donations|length }} donations</p>
    </div>
  </div>

  <!-- Ratings -->
  <div class="mb-6">
    <h4 class="font-semibold text-lg text-yellow-700 mb-2">Ratings</h4>
    {% comment %}
    <p>
      Average: {% if ratings %}
      {{ratings|map(attribute='value')|sum|divisibleby:ratings|length|floatformat:1}}
      {% else %} Not rated yet. {% endif %}
    </p>
    {% endcomment %}
  </div>

  <!-- Comments Section -->
  <div class="bg-white rounded shadow p-6 mb-6">
    <h4 class="text-lg font-bold mb-4">Comments ({{ comments|length }})</h4>
    {% for comment in comments %}
    <div class="border-b border-gray-200 pb-3 mb-3">
      <p class="text-gray-800 font-semibold">{{ comment.user.username }}</p>
      <p class="text-gray-600 text-sm">{{ comment.text }}</p>
      <p class="text-xs text-gray-400">
        {{ comment.created_at|date:"F j, Y, g:i a" }}
      </p>
    </div>
    {% empty %}
    <p class="text-gray-500">No comments yet.</p>
    {% endfor %}
  </div>

  <!-- Reports (visible to admin only maybe) -->
  <div class="bg-red-50 p-4 rounded border border-red-200">
    <h4 class="font-semibold text-red-700 mb-1">Reports</h4>
    <p class="text-red-900">{{ reports|length }} report(s) submitted.</p>
  </div>
</div>
<div>
  <a href="{% url 'projects:report_project' project.id %}"
    class="inline-block mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
    Report Project
  </a>
</div>
{% endblock %} {% block scripts %}
<script>
  const swiper = new Swiper(".mySwiper", {
    loop: true,
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
    pagination: {
      el: ".swiper-pagination",
    },
  });
</script>
{% endblock %}
